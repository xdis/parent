<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zyxy.common.mapper.ArbitratorInfoMapper">
  <resultMap id="BaseResultMap" type="com.zyxy.common.domain.ArbitratorInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ID" jdbcType="VARCHAR" property="id" />
    <result column="USER_ID" jdbcType="VARCHAR" property="userId" />
    <result column="BIRTHDAY" jdbcType="VARCHAR" property="birthday" />
    <result column="VOCATION" jdbcType="VARCHAR" property="vocation" />
    <result column="ACCEPT_STATUS" jdbcType="CHAR" property="acceptStatus" />
    <result column="SPECIALTY" jdbcType="VARCHAR" property="specialty" />
    <result column="ADDRESS" jdbcType="VARCHAR" property="address" />
    <result column="CREATER_ID" jdbcType="VARCHAR" property="createrId" />
    <result column="CREATE_DATE" jdbcType="VARCHAR" property="createDate" />
    <result column="CREATE_TIME" jdbcType="VARCHAR" property="createTime" />
    <result column="UPDATE_ID" jdbcType="VARCHAR" property="updateId" />
    <result column="UPDATE_DATE" jdbcType="VARCHAR" property="updateDate" />
    <result column="UPDATE_TIME" jdbcType="VARCHAR" property="updateTime" />
    <result column="HEAD_PHOTO" jdbcType="VARCHAR" property="headPhoto" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ID, USER_ID, BIRTHDAY, VOCATION, ACCEPT_STATUS, SPECIALTY, ADDRESS, CREATER_ID, CREATE_DATE, 
    CREATE_TIME, UPDATE_ID, UPDATE_DATE, UPDATE_TIME, HEAD_PHOTO
  </sql>
  <select id="selectByExample" parameterType="com.zyxy.common.domain.ArbitratorInfoExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from arbitrator_info
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from arbitrator_info
    where ID = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from arbitrator_info
    where ID = #{id,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.zyxy.common.domain.ArbitratorInfoExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from arbitrator_info
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.zyxy.common.domain.ArbitratorInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into arbitrator_info (ID, USER_ID, BIRTHDAY, 
      VOCATION, ACCEPT_STATUS, SPECIALTY, 
      ADDRESS, CREATER_ID, CREATE_DATE, 
      CREATE_TIME, UPDATE_ID, UPDATE_DATE, 
      UPDATE_TIME, HEAD_PHOTO)
    values (#{id,jdbcType=VARCHAR}, #{userId,jdbcType=VARCHAR}, #{birthday,jdbcType=VARCHAR}, 
      #{vocation,jdbcType=VARCHAR}, #{acceptStatus,jdbcType=CHAR}, #{specialty,jdbcType=VARCHAR}, 
      #{address,jdbcType=VARCHAR}, #{createrId,jdbcType=VARCHAR}, #{createDate,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=VARCHAR}, #{updateId,jdbcType=VARCHAR}, #{updateDate,jdbcType=VARCHAR}, 
      #{updateTime,jdbcType=VARCHAR}, #{headPhoto,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.zyxy.common.domain.ArbitratorInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into arbitrator_info
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="userId != null">
        USER_ID,
      </if>
      <if test="birthday != null">
        BIRTHDAY,
      </if>
      <if test="vocation != null">
        VOCATION,
      </if>
      <if test="acceptStatus != null">
        ACCEPT_STATUS,
      </if>
      <if test="specialty != null">
        SPECIALTY,
      </if>
      <if test="address != null">
        ADDRESS,
      </if>
      <if test="createrId != null">
        CREATER_ID,
      </if>
      <if test="createDate != null">
        CREATE_DATE,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="updateId != null">
        UPDATE_ID,
      </if>
      <if test="updateDate != null">
        UPDATE_DATE,
      </if>
      <if test="updateTime != null">
        UPDATE_TIME,
      </if>
      <if test="headPhoto != null">
        HEAD_PHOTO,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=VARCHAR},
      </if>
      <if test="birthday != null">
        #{birthday,jdbcType=VARCHAR},
      </if>
      <if test="vocation != null">
        #{vocation,jdbcType=VARCHAR},
      </if>
      <if test="acceptStatus != null">
        #{acceptStatus,jdbcType=CHAR},
      </if>
      <if test="specialty != null">
        #{specialty,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="createrId != null">
        #{createrId,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        #{createDate,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="updateId != null">
        #{updateId,jdbcType=VARCHAR},
      </if>
      <if test="updateDate != null">
        #{updateDate,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=VARCHAR},
      </if>
      <if test="headPhoto != null">
        #{headPhoto,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.zyxy.common.domain.ArbitratorInfoExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(*) from arbitrator_info
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update arbitrator_info
    <set>
      <if test="record.id != null">
        ID = #{record.id,jdbcType=VARCHAR},
      </if>
      <if test="record.userId != null">
        USER_ID = #{record.userId,jdbcType=VARCHAR},
      </if>
      <if test="record.birthday != null">
        BIRTHDAY = #{record.birthday,jdbcType=VARCHAR},
      </if>
      <if test="record.vocation != null">
        VOCATION = #{record.vocation,jdbcType=VARCHAR},
      </if>
      <if test="record.acceptStatus != null">
        ACCEPT_STATUS = #{record.acceptStatus,jdbcType=CHAR},
      </if>
      <if test="record.specialty != null">
        SPECIALTY = #{record.specialty,jdbcType=VARCHAR},
      </if>
      <if test="record.address != null">
        ADDRESS = #{record.address,jdbcType=VARCHAR},
      </if>
      <if test="record.createrId != null">
        CREATER_ID = #{record.createrId,jdbcType=VARCHAR},
      </if>
      <if test="record.createDate != null">
        CREATE_DATE = #{record.createDate,jdbcType=VARCHAR},
      </if>
      <if test="record.createTime != null">
        CREATE_TIME = #{record.createTime,jdbcType=VARCHAR},
      </if>
      <if test="record.updateId != null">
        UPDATE_ID = #{record.updateId,jdbcType=VARCHAR},
      </if>
      <if test="record.updateDate != null">
        UPDATE_DATE = #{record.updateDate,jdbcType=VARCHAR},
      </if>
      <if test="record.updateTime != null">
        UPDATE_TIME = #{record.updateTime,jdbcType=VARCHAR},
      </if>
      <if test="record.headPhoto != null">
        HEAD_PHOTO = #{record.headPhoto,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update arbitrator_info
    set ID = #{record.id,jdbcType=VARCHAR},
      USER_ID = #{record.userId,jdbcType=VARCHAR},
      BIRTHDAY = #{record.birthday,jdbcType=VARCHAR},
      VOCATION = #{record.vocation,jdbcType=VARCHAR},
      ACCEPT_STATUS = #{record.acceptStatus,jdbcType=CHAR},
      SPECIALTY = #{record.specialty,jdbcType=VARCHAR},
      ADDRESS = #{record.address,jdbcType=VARCHAR},
      CREATER_ID = #{record.createrId,jdbcType=VARCHAR},
      CREATE_DATE = #{record.createDate,jdbcType=VARCHAR},
      CREATE_TIME = #{record.createTime,jdbcType=VARCHAR},
      UPDATE_ID = #{record.updateId,jdbcType=VARCHAR},
      UPDATE_DATE = #{record.updateDate,jdbcType=VARCHAR},
      UPDATE_TIME = #{record.updateTime,jdbcType=VARCHAR},
      HEAD_PHOTO = #{record.headPhoto,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.zyxy.common.domain.ArbitratorInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update arbitrator_info
    <set>
      <if test="userId != null">
        USER_ID = #{userId,jdbcType=VARCHAR},
      </if>
      <if test="birthday != null">
        BIRTHDAY = #{birthday,jdbcType=VARCHAR},
      </if>
      <if test="vocation != null">
        VOCATION = #{vocation,jdbcType=VARCHAR},
      </if>
      <if test="acceptStatus != null">
        ACCEPT_STATUS = #{acceptStatus,jdbcType=CHAR},
      </if>
      <if test="specialty != null">
        SPECIALTY = #{specialty,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        ADDRESS = #{address,jdbcType=VARCHAR},
      </if>
      <if test="createrId != null">
        CREATER_ID = #{createrId,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        CREATE_DATE = #{createDate,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="updateId != null">
        UPDATE_ID = #{updateId,jdbcType=VARCHAR},
      </if>
      <if test="updateDate != null">
        UPDATE_DATE = #{updateDate,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        UPDATE_TIME = #{updateTime,jdbcType=VARCHAR},
      </if>
      <if test="headPhoto != null">
        HEAD_PHOTO = #{headPhoto,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.zyxy.common.domain.ArbitratorInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update arbitrator_info
    set USER_ID = #{userId,jdbcType=VARCHAR},
      BIRTHDAY = #{birthday,jdbcType=VARCHAR},
      VOCATION = #{vocation,jdbcType=VARCHAR},
      ACCEPT_STATUS = #{acceptStatus,jdbcType=CHAR},
      SPECIALTY = #{specialty,jdbcType=VARCHAR},
      ADDRESS = #{address,jdbcType=VARCHAR},
      CREATER_ID = #{createrId,jdbcType=VARCHAR},
      CREATE_DATE = #{createDate,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=VARCHAR},
      UPDATE_ID = #{updateId,jdbcType=VARCHAR},
      UPDATE_DATE = #{updateDate,jdbcType=VARCHAR},
      UPDATE_TIME = #{updateTime,jdbcType=VARCHAR},
      HEAD_PHOTO = #{headPhoto,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=VARCHAR}
  </update>
  
  <select id="queryArbitratorPersonalInfo" resultType="com.zyxy.common.vo.ArbitratorPersonalInfoVO">
  	SELECT 
  		userInfo.name name, 
  		arbitratorInfo.birthday birthday, 
  		arbitratorInfo.vocation vocation, 
  		arbitratorInfo.specialty specialty, 
  		arbitratorInfo.address address,
  		arbitratorInfo.accept_status acceptStatus
  	FROM
  		arbitrator_info arbitratorInfo
  		LEFT JOIN 
  			user_info userInfo
  		ON
  			arbitratorInfo.user_id = userInfo.id
  	WHERE
  		arbitratorInfo.id = #{arbitratorId,jdbcType=VARCHAR}
  </select>
  
  <select id="queryArbitratorBaseInfo" resultType="com.zyxy.common.vo.ArbitratorBaseInfoVO">
  	SELECT
  		userInfo.name name,
  		userInfo.phone phone
  	FROM
  		user_info userInfo
  		LEFT JOIN
  			arbitrator_info arbitratorInfo
  		ON userInfo.id = arbitratorInfo.user_id
  	WHERE
  		arbitratorInfo.id = #{arbitratorId,jdbcType=VARCHAR}
  </select>
  <select id="selectArbitratorInfoByCaseId" resultType="com.zyxy.common.vo.LitigantArbitratorInfoVO">
  	SELECT 
  		ui.name name, 
  		YEAR ( FROM_DAYS( DATEDIFF( now( ), ai.birthday))) age, 
  		ai.vocation job, 
  		ai.specialty specialty, 
  		ai.head_photo portrait
  	FROM
  		arbitrator_info ai,
  		user_info ui,
  		case_arbitrator ca
  	WHERE
  		ai.user_id = ui.id
  	AND
  		ai.id = ca.arbitrator_id
  	AND
  		ca.case_id =#{caseId}
  	AND
  		ca.status = ${@com.zyxy.common.enums.CaseArbitratorStatusEnum@OK.getCode()}
  </select>

  <select id="queryArbitrationList" resultType="com.zyxy.common.vo.ArbitratorListVO">
    SELECT
        'default' portrait,
        u.NAME name,
        u.SEX sex,
        u.id arbitratorId,
        a.BIRTHDAY age,
        a.VOCATION job,
        a.SPECIALTY specialty
    FROM
        arbitrator_info a,
        user_info u
    WHERE
        u.id = a.user_id
        AND accept_status = ${@com.zyxy.common.enums.ArbitratorAcceptStatusEnum@PICK_UP_CASE.getCode()}
  </select>
  
  	<!--查询仲裁委端，仲裁员信息列表 -->
   <select id="queryArbitratorInLists" resultType="com.zyxy.common.vo.ArbitratorInformationVO" parameterType="com.zyxy.common.dto.ArbitratorEnquiriesDTO">
		SELECT
			ai.id id,
			ui. NAME name,
			ui.phone phone,
			ai.user_id userId,
			ai.specialty specialty,
			ai.create_date createDate,
			ai.birthday dateOfBirth,
			ai.vocation vocation,
			ai.address address,
			ai.black_list_status blackList,
			ac.status status
		FROM
			user_info ui,
			arbitrator_info ai 
			LEFT JOIN arbitrator_change_profile_record ac ON ai.user_id=ac.creater_id
		WHERE
		ui.id = ai.user_id
		AND
		ai.delete_status=${@com.zyxy.common.enums.DeleteStatusEnum@NORMAL.getCode()}
    <if test="name !=null and name !=''">
      AND
       ui.name=#{name}
    </if>
    <if test="phone !=null and phone !=''">
      AND
       ui.phone=#{phone}
    </if>
    <if test="status !=null and status !=''">
      AND
       ai.black_list_status=#{status}
    </if>
    <if test="id !=null and id !=''">
      AND
       ai.id=#{id}
    </if>
     <if test="toAudit!=null and toAudit !='' " >
      AND
       ai.black_list_status=${@com.zyxy.common.enums.BlackListStatusEnum@NOT_TO_JOIN.getCode()}
    </if>
    <if test="underReview!=null and underReview !='' ">
      AND
       ai.black_list_status=${@com.zyxy.common.enums.BlackListStatusEnum@JOIN_IN.getCode()}
    </if>
    ORDER BY
    	ai.create_date DESC
  </select>
  
  
  <update id="updateArbitratorDisable" parameterType="String">
  	UPDATE arbitrator_info
  	SET black_list_status=${@com.zyxy.common.enums.BlackListStatusEnum@JOIN_IN.getCode()}
  	WHERE
  	id=#{id}
  </update>
  
  <select id="queryArbitratorAudit" parameterType="String" resultType="com.zyxy.common.vo.ArbitratorInfoAduitVO">
	SELECT
		ai.id id,
		ui. NAME NAME,
		ai.birthday birthDates,
		ai.vocation sourceOccupation,
		ai.specialty sourceSpecialty,
		ai.address sourceAddress,
		sf.sys_path sourceIdCard,
		ac.job newOccupation,
		ac.speciality newSpecialty,
		ac.address newAddress,
		sfi.sys_path newIdCard,
		ac.id_card newIdentityId,
		ac.remark newRemark,
		ac.id newId
	FROM
		user_info ui,
		arbitrator_info ai,
		arbitrator_change_profile_record ac,
		sys_file sf,
		sys_file sfi
	WHERE
		ui.id = ai.user_id
	AND ac.creater_id = ai.user_id
	AND sf.id = ai.head_photo
	AND sfi.id = ac.id_card
	AND ai.id = #{id}
  </select>
  
  <!-- 将仲裁员最新信息更新到仲裁员表中 -->
  <update id="updateArbitratorInfo">
  	UPDATE arbitrator_info
  	SET vocation=#{newOccupation},
	  	specialty=#{newSpecialty},
	  	address=#{newAddress},
	  	head_photo=#{newIdentityId},
	  	update_date=#{updateDate},
	  	update_time=#{updateTime}
	WHERE
		id=#{id}
  </update>
  
  <!--  更新删除状态或黑名单状态 -->
  <update id="updateStatus" parameterType="com.zyxy.common.dto.ArbitratorInfoUpdateDTO">
  	UPDATE arbitrator_info
  	SET 
	  	<if test=" blackListStatus!=null and blackListStatus !='' ">
	  		black_list_status=#{blackListStatus}
	  	</if>
	  	<if test=" deleteStatus!=null and deleteStatus!='' ">
	  		delete_status=#{deleteStatus}
	  	</if>
	WHERE
		id=#{id}
  </update>
  
</mapper>